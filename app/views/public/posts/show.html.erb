<div class="container">
  <div class="row mt-2">
    <div class="col-md-4 mt-3">
      <div class="main__visual-infomation-subtitle proxima-semibold">Post</div>
      <h2 class="text-center mb-3"><%= @post.title %></h2>
      <div class="main__visual-infomation-subtitle proxima-semibold">Tags</div>
      <div class="d-flex flex-wrap mt-3 mb-3">
        <% @tag.each do |tag| %>
          <p class="m-1"><%= link_to tag.name, search_tag_path(tag_id: tag.id), class: 'btn btn-primary btn-sm' %></p>
        <% end %>
      </div>
      <div class="main__visual-infomation-subtitle proxima-semibold">Rating</div>
      <div class="col-md-8 offset-md-2 mt-3">
        <div id="rate_<%= @post.id %>"></div>
          <script>
            let elem = document.querySelector('#rate_<%= @post.id %>');
            let opt = {  
              starOn: "<%= asset_path('star-on.png') %>",
              starOff: "<%= asset_path('star-off.png') %>",
              starHalf: "<%= asset_path('star-half.png') %>",
              score: "<%= @post.rate %>",
              readOnly: true,
             };
            raty(elem,opt);
          </script>
      </div>
    </div>
    <div class="col-md-7 offset-md-1">
      <div class="sliderWrapper">
	      <div class="slider">
          <% @post.images.each do |image| %>
            <div class="card bg-white text-white">
              <div class="position-relative">
                <%= image_tag image, width: '100%', height: '300px' %>
                <div id = "favorite_<%= @post.id %>">
                  <%= render partial: "public/favorites/favorite", locals: {post: @post} %>
                </div>
              </div>
            </div>
          <% end %>
	      </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-8 offset-md-2">
      <p><%= @post.introduction %></p>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-4 offset-md-1">
      <p>Comments: <%= @post_comments.count %></p>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-12 col-sm-12">
    <%= form_with model: [@post, @post_comment], url: post_post_comments_path(post_id: @post.id), method: :post do |f| %>
    <%= render 'public/customers/error', obj: @post_comment %>
    <div class="row mt-3">
      <div class="col-md-8 offset-md-2">
        <%= f.text_area :message, rows: '3', placeholder: "コメントをここに入力してください。",class: "col-md-12" %>
      </div>
      <div class="col-md-2 mt-4  text-center">
        <%= f.submit "submit", class: "submit_btn" %>
      </div>
    </div>
    <% end %>
    </div>
  </div>
  <% @post_comments.each do |comment| %>
  <div class="row mt-3">
    <div class="col-md-10 offset-md-1 mt-3">
      <p><%= comment.customer.name %></p>
    </div>
  </div>
  <div class="row mt-1">
    <div class="col-md-11 offset-md-1">
      <p><%= comment.message %></p>
    </div>
  </div>
  <div class="row mt-1">
    <div class="offset-md-1">
      <p><%= comment.created_at.strftime('%Y/%m/%d') %></p>
    </div>
    <div class="col-md-1 offset-md-8">
      <% if comment.customer == current_customer %>
        <p><%= link_to "Delete", post_post_comment_path(comment.post, comment), method: :delete,class: "destroy_btn" %></p>
      <% end %>
    </div>
  </div>
  <% end %>
  <% if @post.customer == current_customer %>
  <div class="row mt-3">
    <div class="col-md-12">
    <h2 class="text-center fs-2">about post</h2>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-1 offset-md-4 col-sm-5 text-center">
      <%= link_to 'edit', edit_post_path(@post), class: 'edit_btn' %>
    </div>
    <div class="col-md-1 offset-md-4 col-sm-5 text-center">
      <%= link_to "delete", post_path(@post), method: :delete, data: { confirm: '本当に消しますか？' },class: "destroy_btn" %>
    </div>
  </div>
  <% end %>
  <div class="row mt-3">
    <div class="col-md-10 offset-md-1 box">
      <%= render 'public/customers/customer_info', customer: @customer %>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-md-10 offset-md-1">
      <h2 class="text-center"><%= @customer.name %>さんの他の投稿</h2>
      <div class="d-flex flex-wrap">
        <%= render 'public/posts/index_form', posts: @posts %>
      </div>
    </div>
  </div>
</div>